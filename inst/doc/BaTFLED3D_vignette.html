<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Example usage</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<p>BaTFLED is a machine learning algorithm designed to make predictions and determine interactions in data that varies along three independent modes. For example BaTFLED was developed to predict the growth of cell lines when treated with drugs at different doses. The first mode corresponds to cell lines and incorporates predictors such as cell line genomics and growth conditions. The second mode corresponds to drugs and incorporates predictors indicating known targets and structural features. The third mode corresponds to dose and there are no dose-specific predictors (although the algorithm is capable of including predictors for the third mode if present). </p>

<p>BaTFLED assumes a generative model where matrices of predictors are multiplied through projection matrices to form latent representations of the input data. These latent representations vectors are analogous to principal component vectors. Matrices containing the latent vectors are combined to form the response tensor which, in this case, are measures of the growth of cell lines after treatment with different drugs at different doses.</p>

<p>The algorithm learns distributions on values in the projection matrices and latent matrices using a Bayesian framework. Prior distributions on the projection matrices can encourge a sparse representation of the input data. Values in the model are learned through variational approximation which maximizes a lower bound on the posterior likelihood by iteratively updating values in the model. This process is deterministic given a random initialization and update ordering.</p>

<h2>Example usage</h2>

<p>This document will walk through the use of BaTFLED on a small simulated dataset.</p>

<p>First we check for installation of necessary packages, install them if necessary and load them.</p>

<pre><code class="r">library(BaTFLED3D)

# Set up backend for parallel execution
cores &lt;- 1
if(.Platform$OS.type == &quot;windows&quot;) {
  clust &lt;- parallel::makeCluster(cores)
  doParallel::registerDoParallel(clust)
} else doMC::registerDoMC(cores)
</code></pre>

<h2>Generating a simulated dataset</h2>

<p>Next we generate simulated data according to the assumed generative model which we will try to reconstruct using BaTFLED. Many aspects of model building can be adjusted, use <code>?get_data_params</code> to see them.</p>

<pre><code class="r">args &lt;- list(&#39;decomp=Tucker&#39;,             # Should be either CP or Tucker factorization
             &#39;m1.rows=20&#39;, &#39;m1.cols=80&#39;,  # Dimensions of input matrices
             &#39;m2.rows=25&#39;, &#39;m2.cols=100&#39;,
             &#39;m3.rows=5&#39;, &#39;m3.cols=0&#39;,
             &#39;A1.intercept=T&#39;,            # Add intercepts to projection matrices
             &#39;A2.intercept=T&#39;, 
             &#39;A3.intercept=F&#39;,
             &#39;H1.intercept=T&#39;,            # Add intercepts to latent matrices
             &#39;H2.intercept=T&#39;, 
             &#39;H3.intercept=T&#39;,
             &#39;m1.true=8&#39;,                 # Number of predictors affecting output 
             &#39;m2.true=10&#39;, 
             &#39;m3.true=0&#39;,
             &#39;R1=4&#39;, &#39;R2=4&#39;, &#39;R3=4&#39;,      # Core dimension
             &#39;core.spar=0.1&#39;,             # Amount of sparsity in the core [0-1], 1=no sparsity
             &#39;noise.sd=0.2&#39;               # Amount of Gaussian noise added to responses
)
data.params &lt;- get_data_params(args)
toy &lt;- mk_toy(data.params)
</code></pre>

<p>The <code>toy</code> list contains the input matrices (<code>mode1.X</code>, <code>mode2.X</code> and <code>mode3.X</code>), the sparse projection matrices (<code>mode1.A</code>, <code>mode2.A</code> and <code>mode3.A</code>), the latent matrices (<code>mode1.H</code>, <code>mode2.H</code> and <code>mode3.H</code>), the core tensor (<code>core</code> if a &#39;Tucker&#39; decomposition is used) and the response tensor (<code>resp</code>). The matrices and slices of the tensors can be view using <code>im_mat()</code>. Note that there are normally some patterns visible in the response tensor.</p>

<pre><code class="r">par(mfrow=c(2,2), mar=c(2,2,2,2), mgp=c(1,1,1))
im_mat(toy$mode1.X, main=&#39;Mode 1 X&#39;, ylab=&#39;Samples&#39;, xlab=&#39;Predictors&#39;)
im_mat(toy$mode1.A, main=&#39;Mode 1 A&#39;, ylab=&#39;Predictors&#39;, xlab=&#39;Latent factors&#39;)
im_mat(toy$mode1.H, main=&#39;Mode 1 H&#39;, ylab=&#39;Samples&#39;, xlab=&#39;Constant + latent factors&#39;)
im_mat(toy$resp[,,1], main=&#39;Slice of response tensor&#39;,
       xlab=&#39;Mode 2 samples&#39;, ylab=&#39;Mode 1 samples&#39;)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk mode 1 mats" alt="plot of chunk mode 1 mats" style="display: block; margin: auto;" /></p>

<h2>Training a BaTFLED model</h2>

<p>Now that we&#39;ve built a model, let&#39;s see if we can get BaTFLED to learn the values in the projection and latent matrices and the core tensor given just the input data and responses. We separate two of the &#39;samples&#39; from modes 1 and 2 to be used as test data and form <code>input_data</code> objects. We also set a percentage of training responses to <code>NA</code> to be used for &#39;warm start&#39; testing. If the <code>X</code> matrices contain constants they are removed since these is optionally added during training.</p>

<pre><code class="r">train.data &lt;- input_data$new(
  mode1.X=toy$mode1.X[-c(1,2), !grepl(&#39;const&#39;, colnames(toy$mode1.X))],
  mode2.X=toy$mode2.X[-c(1,2), !grepl(&#39;const&#39;, colnames(toy$mode2.X))],
  mode3.X=toy$mode3.X[, !grepl(&#39;const&#39;, colnames(toy$mode3.X))],
  resp=toy$resp[-c(1,2),-c(1,2),])

# Remove &#39;warm.per&#39; percent of responses to be used as &#39;warm&#39; test data
warm.per &lt;- 0.05
warm.idx &lt;- sample(1:prod(dim(train.data$resp)), prod(dim(train.data$resp))*warm.per)
warm.resp &lt;- train.data$resp[sort(warm.idx)]
train.data$resp[warm.idx] &lt;- NA
train.data$delta[warm.idx] &lt;- 0

m1.test.data &lt;- input_data$new(
  mode1.X=toy$mode1.X[c(1,2), !grepl(&#39;const&#39;, colnames(toy$mode1.X))],
  mode2.X=toy$mode2.X[-c(1,2), !grepl(&#39;const&#39;, colnames(toy$mode2.X))],
  mode3.X=toy$mode3.X[, !grepl(&#39;const&#39;, colnames(toy$mode3.X))],
  resp=toy$resp[c(1,2),-c(1,2),])
m2.test.data &lt;- input_data$new(
  mode1.X=toy$mode1.X[-c(1,2), !grepl(&#39;const&#39;, colnames(toy$mode1.X))],
  mode2.X=toy$mode2.X[c(1,2), !grepl(&#39;const&#39;, colnames(toy$mode2.X))],
  mode3.X=toy$mode3.X[, !grepl(&#39;const&#39;, colnames(toy$mode3.X))],
  resp=toy$resp[-c(1,2),c(1,2),])
m1m2.test.data &lt;- input_data$new(
  mode1.X=toy$mode1.X[c(1,2), !grepl(&#39;const&#39;, colnames(toy$mode1.X))],
  mode2.X=toy$mode2.X[c(1,2), !grepl(&#39;const&#39;, colnames(toy$mode2.X))],
  mode3.X=toy$mode3.X[, !grepl(&#39;const&#39;, colnames(toy$mode3.X))],
  resp=toy$resp[c(1,2),c(1,2),])
</code></pre>

<p>To train BaTFLED we create and initialize a <code>model</code> object. Again there are a lot of parameters to specify, a subset of which are indicated below. To see all available parameters, their descriptions and defaults run <code>?get_model_params</code>. Note: decomp=CP is not currently implmented.</p>

<pre><code class="r">args &lt;- list(&#39;decomp=Tucker&#39;, &#39;row.share=T&#39;,
             &#39;A1.intercept=T&#39;, &#39;A2.intercept=T&#39;, &#39;A3.intercept=F&#39;,
             &#39;H1.intercept=T&#39;, &#39;H2.intercept=T&#39;, &#39;H3.intercept=T&#39;,
             &#39;plot=F&#39;, &#39;verbose=F&#39;,
             &#39;R1=4&#39;, &#39;R2=4&#39;, &#39;R3=4&#39;,
             &#39;sigma2=auto&#39;,
             &#39;m1.alpha=1e-10&#39;, &#39;m2.alpha=1e-10&#39;, &#39;m3.alpha=1&#39;,
             &#39;m1.beta=1e10&#39;, &#39;m2.beta=1e10&#39;, &#39;m3.beta=1&#39;,
             &#39;core.0D.alpha=1&#39;, &#39;core.0D.beta=1&#39;, 
             &#39;core.1D.alpha=1e-4&#39;, &#39;core.1D.beta=1e4&#39;,
             &#39;core.2D.alpha=1e-8&#39;, &#39;core.2D.beta=1e8&#39;,
             &#39;core.3D.alpha=1e-12&#39;, &#39;core.3D.beta=1e12&#39;,
             &#39;parallel=T&#39;, &#39;cores=1&#39;, &#39;lower.bnd=T&#39;, 
             &#39;update.order=c(3,1,2)&#39;, &#39;show.mode=c(1,2,3)&#39;)
model.params &lt;- get_model_params(args)
model &lt;- mk_model(train.data, model.params)
model$rand_init(model.params)
</code></pre>

<pre><code>## [1] &quot;** Initialization complete **&quot;
</code></pre>

<p><code>model</code> is an <code>R6</code> object containing A mean matrices (ex. <code>model$mode1.A.mean</code>), A covariance arrays (ex. <code>model$mode1.A.cov</code>), H mean and variance matrices (ex. <code>model$mode1.H.mean</code> and <code>model$mode1.H.var</code>), arrays for the core mean and variance (<code>model$core.mean</code> and <code>model$core.var</code>), an array of predicted responses (<code>model$resp</code>) and parameters for the prior distributions. Initially these are random values sampled from Gaussian distributions.</p>

<pre><code class="r">par(mfrow=c(2,2), mar=c(2,2,2,2), mgp=c(1,0,5))
im_mat(model$mode1.A.mean, main=&#39;Mode 1 A mean&#39;, xlab=&#39;Latent factors&#39;, ylab=&#39;Predictors&#39;)
im_mat(model$mode2.A.mean, main=&#39;Mode 2 A mean&#39;, xlab=&#39;Latent factors&#39;, ylab=&#39;Predictors&#39;)
im_mat(model$mode3.H.mean, main=&#39;Mode 3 H mean&#39;, xlab=&#39;Latent factors&#39;, ylab=&#39;Samples&#39;)
if(model.params$decomp==&#39;Tucker&#39;)
  im_mat(model$core.mean[,,1], main=&#39;Core mean&#39;, xlab=&#39;mode 2 latent&#39;, ylab=&#39;Mode 1 latent&#39;)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk image model" alt="plot of chunk image model" style="display: block; margin: auto;" /></p>

<p>We&#39;re now ready to train the BaTFLED model. If <code>params$plot=TRUE</code> the predictions and some of the learned matrices will be displayed during training. You can adjust which A and H matrices are displayed by changing <code>params$show.mode</code>. The observed response values for the &#39;warm&#39; data are set to zero, so they appear along a vertical line in the first plot. You may want to adjust the number of <code>cores</code> depending on how many processors you have on your machine and the number of iterations run <code>reps</code>. With 50 iterations a Tucker decomposition can take about 10-15 minutes.</p>

<pre><code class="r">reps &lt;- 5

# Data frame to store RMSEs &amp; explained variances for test data while training 
test.results &lt;- numeric(0)

trained &lt;- model$clone()

for(i in 1:reps) {
train(d=train.data, m=trained, params=model.params)

# Get cold results
test.results &lt;- test_results(m=trained, d=train.data, test.results=test.results,
warm.resp=warm.resp, test.m1=m1.test.data, test.m2=m2.test.data, 
test.m1m2=m1m2.test.data)
}

# Stop cluster (if using parallel package)
if(.Platform$OS.type == &quot;windows&quot;) parallel::stopCluster(clust)
</code></pre>

<h2>Exploring the resulting model</h2>

<p>Now that the model has been trained, let&#39;s compare the learned matrices to the generating <code>toy</code> model. Since the latent factors (columns of the A &amp; H matrices) can be permuted or scaled without changing predictions, the function <code>im_2_mat</code> scales and reorders columns of the two matrices and tries to match the latent factors. The new ordering for the second matrix is returned (with negatives indicating negative scaling) so that it can be used to order the core.</p>

<pre><code class="r">par(mfrow=c(3,4), mar=c(2,2,2,2))
im_2_mat(toy$mode1.A, trained$mode1.A.mean, main1=&#39;Mode 1 A true&#39;, main2=&#39;Mode 1 A learned&#39;)
m1.H.order &lt;- im_2_mat(toy$mode1.H[-(1:2),], trained$mode1.H.mean, 
                       main1=&#39;Mode 1 H true&#39;, main2=&#39;Mode 1 H learned&#39;)
im_2_mat(toy$mode2.A, trained$mode2.A.mean, main1=&#39;Mode 2 A true&#39;, main2=&#39;Mode 2 A learned&#39;)
m2.H.order &lt;- im_2_mat(toy$mode2.H[-(1:2),], trained$mode2.H.mean, 
                       main1=&#39;Mode 2 H true&#39;, main2=&#39;Mode 2 H learned&#39;)
m3.H.order &lt;- im_2_mat(toy$mode3.H, trained$mode3.H.mean, 
                       main1=&#39;Mode 3 H true&#39;, main2=&#39;Mode 3 H learned&#39;)
if(model.params$decomp==&#39;Tucker&#39;) {
  core.reorder &lt;- trained$core.mean[abs(m1.H.order), abs(m2.H.order), abs(m3.H.order)]
  core.reorder &lt;- core.reorder * outer(sign(m1.H.order), outer(sign(m2.H.order), sign(m3.H.order)))
  im_2_mat(toy$core[,,1], core.reorder[,,1], sort=F, center=T, scale=&#39;all&#39;,
           main1=&#39;Core mode 1 slice true&#39;, main2=&#39;Core mode 1 slice learned&#39;)
}
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk compare model matrices" alt="plot of chunk compare model matrices" style="display: block; margin: auto;" /></p>

<p>To quantify how well BaTFLED has chosen predictors we can generate receiver operating characteristic (ROC) curves for each of the modes with predictors. Predictors are &#39;chosen&#39; if the sum of squared values in the corresponding row of the scaled A matrix is large.</p>

<pre><code class="r">par(mfrow=c(1,2), mar=c(3,3,2,2), mgp=c(2,1,0))
plot_roc(toy$mode1.A, trained$mode1.A.mean, main=&#39;Mode 1&#39;)
plot_roc(toy$mode2.A, trained$mode2.A.mean, main=&#39;Mode 2&#39;)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk ROC curves" alt="plot of chunk ROC curves" style="display: block; margin: auto;" /></p>

<p>BaTFLED optionally stores values of the lower bound (<code>lower.bnd</code>), root mean squared error (<code>RMSE</code>), explained variation (<code>exp.var</code>), Pearson correlation (<code>p.cor</code>) and Spearman correlation (<code>s.cor</code>) for training data.</p>

<pre><code class="r">par(mfrow=c(2,2), mar=c(3,3,2,2), mgp=c(2,1,0))
if(model.params$lower.bnd) plot(trained$lower.bnd, main=&#39;Lower bound&#39;)
if(model.params$RMSE)      plot(trained$RMSE, main=&#39;Training RMSE&#39;)
if(model.params$exp.var)   plot(trained$exp.var, main=&#39;Training explained variation&#39;)
if(model.params$cor)       plot(trained$s.cor, main=&#39;Spearman correlation&#39;)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk training measures" alt="plot of chunk training measures" style="display: block; margin: auto;" /></p>

<p>Also the <code>test.results</code> object in the training loop has stored results for the test data which can be plotted with the functions below.</p>

<pre><code class="r">par(mfrow=c(2,2))
plot_test_RMSE(test.results, main=&quot;Test RMSEs&quot;)
</code></pre>

<pre><code>## Warning in if (is.na(ylim)) ylim = c(0, max(test.results[-1,
## grepl(&quot;RMSE&quot;, : the condition has length &gt; 1 and only the first element
## will be used
</code></pre>

<pre><code class="r">plot_test_exp_var(test.results, main=&quot;Test explained variances&quot;)
plot_test_cor(test.results, main=&quot;Pearson correlation&quot;)
</code></pre>

<pre><code>## Warning in if (is.na(ylim)) ylim = range(test.results[-1, cor.cols], na.rm
## = T): the condition has length &gt; 1 and only the first element will be used
</code></pre>

<pre><code class="r">plot_test_cor(test.results, main=&quot;Spearman correlation&quot;, method=&#39;spearman&#39;)
</code></pre>

<pre><code>## Warning in if (is.na(ylim)) ylim = range(test.results[-1, cor.cols], na.rm
## = T): the condition has length &gt; 1 and only the first element will be used
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk unnamed-chunk-2" alt="plot of chunk unnamed-chunk-2" style="display: block; margin: auto;" /></p>

</body>

</html>
