<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Example usage</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<p>BaTFLED is a machine learning algorithm designed to make predictions and determine interactions in data that varies along three independent modes. For example BaTFLED was developed to predict the growth of cell lines when treated with drugs at different doses. The first mode corresponds to cell lines and incorporates predictors such as cell line genomics and growth conditions. The second mode corresponds to drugs and incorporates predictors indicating known targets and structural features. The third mode corresponds to dose and there are no dose-specific predictors (although the algorithm is capable of including predictors for the third mode if present). </p>

<p>BaTFLED assumes a generative model where matrices of predictors are multiplied through projection matrices to form latent representations of the input data. These latent representations vectors are analogous to principal component vectors. Matrices containing the latent vectors are combined to form the response tensor which, in this case, are measures of the growth of cell lines after treatment with different drugs at different doses.</p>

<p>The algorithm learns distributions on values in the projection matrices and latent matrices using a Bayesian framework. Prior distributions on the projection matrices can encourage a sparse representation of the input data. Values in the model are learned through variational approximation which maximizes a lower bound on the posterior likelihood by iteratively updating values in the model. This process is deterministic given a random initialization and update ordering.</p>

<h2>Example usage</h2>

<p>This document will walk through the use of BaTFLED on a small simulated dataset.</p>

<p>First we check for installation of necessary packages, install them if necessary and load them.</p>

<pre><code class="r">library(BaTFLED3D)

# Set up backend for parallel execution
cores &lt;- 1
if(.Platform$OS.type == &quot;windows&quot;) {
  clust &lt;- parallel::makeCluster(cores)
  doParallel::registerDoParallel(clust)
} else doMC::registerDoMC(cores)
</code></pre>

<h2>Generating a simulated dataset</h2>

<p>Next we generate simulated data according to the assumed generative model which we will try to reconstruct using BaTFLED. Many aspects of model building can be adjusted, use <code>?get_data_params</code> to see them.</p>

<pre><code class="r">args &lt;- list(&#39;decomp=Tucker&#39;,             # Should be either CP or Tucker factorization
             &#39;m1.rows=20&#39;, &#39;m1.cols=80&#39;,  # Dimensions of input matrices
             &#39;m2.rows=25&#39;, &#39;m2.cols=100&#39;,
             &#39;m3.rows=5&#39;, &#39;m3.cols=0&#39;,
             &#39;A1.intercept=T&#39;,            # Add intercepts to projection matrices
             &#39;A2.intercept=T&#39;, 
             &#39;A3.intercept=F&#39;,
             &#39;H1.intercept=T&#39;,            # Add intercepts to latent matrices
             &#39;H2.intercept=T&#39;, 
             &#39;H3.intercept=T&#39;,
             &#39;m1.true=8&#39;,                 # Number of predictors affecting output 
             &#39;m2.true=10&#39;, 
             &#39;m3.true=0&#39;,
             &#39;R1=4&#39;, &#39;R2=4&#39;, &#39;R3=4&#39;,      # Core dimension
             &#39;core.spar=0.5&#39;,             # Amount of sparsity in the core [0-1], 1=no sparsity
             &#39;noise.sd=0.2&#39;               # Amount of Gaussian noise added to responses
)
data.params &lt;- get_data_params(args)
toy &lt;- mk_toy(data.params)
</code></pre>

<p>The <code>toy</code> list contains the input matrices (<code>mode1.X</code>, <code>mode2.X</code> and <code>mode3.X</code>), the sparse projection matrices (<code>mode1.A</code>, <code>mode2.A</code> and <code>mode3.A</code>), the latent matrices (<code>mode1.H</code>, <code>mode2.H</code> and <code>mode3.H</code>), the core tensor (<code>core</code> if a &#39;Tucker&#39; decomposition is used) and the response tensor (<code>resp</code>). The matrices and slices of the tensors can be view using <code>im_mat()</code>. Note that there are normally some patterns visible in the response tensor.</p>

<pre><code class="r">par(mfrow=c(2,2), mar=c(2,2,2,2), mgp=c(1,1,1))
im_mat(toy$mode1.X, main=&#39;Mode 1 X&#39;, ylab=&#39;Samples&#39;, xlab=&#39;Predictors&#39;)
im_mat(toy$mode1.A, main=&#39;Mode 1 A&#39;, ylab=&#39;Predictors&#39;, xlab=&#39;Latent factors&#39;)
im_mat(toy$mode1.H, main=&#39;Mode 1 H&#39;, ylab=&#39;Samples&#39;, xlab=&#39;Constant + latent factors&#39;)
im_mat(toy$resp[,,1], main=&#39;Slice of response tensor&#39;,
       xlab=&#39;Mode 2 samples&#39;, ylab=&#39;Mode 1 samples&#39;)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk mode 1 mats" alt="plot of chunk mode 1 mats" style="display: block; margin: auto;" /></p>

<h2>Training a BaTFLED model</h2>

<p>Now that we&#39;ve built a model, let&#39;s see if we can get BaTFLED to learn the values in the projection and latent matrices and the core tensor given just the input data and responses. We separate two of the &#39;samples&#39; from modes 1 and 2 to be used as test data and form <code>input_data</code> objects. We also set a percentage of training responses to <code>NA</code> to be used for &#39;warm start&#39; testing. If the <code>X</code> matrices contain constants they are removed since these is optionally added during training.</p>

<pre><code class="r">train.data &lt;- input_data$new(
  mode1.X=toy$mode1.X[-c(1,2), !grepl(&#39;const&#39;, colnames(toy$mode1.X))],
  mode2.X=toy$mode2.X[-c(1,2), !grepl(&#39;const&#39;, colnames(toy$mode2.X))],
  mode3.X=toy$mode3.X[, !grepl(&#39;const&#39;, colnames(toy$mode3.X))],
  resp=toy$resp[-c(1,2),-c(1,2),])

# Remove &#39;warm.per&#39; percent of responses to be used as &#39;warm&#39; test data
warm.per &lt;- 0.05
warm.idx &lt;- sample(1:prod(dim(train.data$resp)), prod(dim(train.data$resp))*warm.per)
warm.resp &lt;- train.data$resp[sort(warm.idx)]
train.data$resp[warm.idx] &lt;- NA
train.data$delta[warm.idx] &lt;- 0

m1.test.data &lt;- input_data$new(
  mode1.X=toy$mode1.X[c(1,2), !grepl(&#39;const&#39;, colnames(toy$mode1.X))],
  mode2.X=toy$mode2.X[-c(1,2), !grepl(&#39;const&#39;, colnames(toy$mode2.X))],
  mode3.X=toy$mode3.X[, !grepl(&#39;const&#39;, colnames(toy$mode3.X))],
  resp=toy$resp[c(1,2),-c(1,2),])
m2.test.data &lt;- input_data$new(
  mode1.X=toy$mode1.X[-c(1,2), !grepl(&#39;const&#39;, colnames(toy$mode1.X))],
  mode2.X=toy$mode2.X[c(1,2), !grepl(&#39;const&#39;, colnames(toy$mode2.X))],
  mode3.X=toy$mode3.X[, !grepl(&#39;const&#39;, colnames(toy$mode3.X))],
  resp=toy$resp[-c(1,2),c(1,2),])
m1m2.test.data &lt;- input_data$new(
  mode1.X=toy$mode1.X[c(1,2), !grepl(&#39;const&#39;, colnames(toy$mode1.X))],
  mode2.X=toy$mode2.X[c(1,2), !grepl(&#39;const&#39;, colnames(toy$mode2.X))],
  mode3.X=toy$mode3.X[, !grepl(&#39;const&#39;, colnames(toy$mode3.X))],
  resp=toy$resp[c(1,2),c(1,2),])
</code></pre>

<p>To train BaTFLED we create and initialize a <code>model</code> object. Again there are a lot of parameters to specify, a subset of which are indicated below. To see all available parameters, their descriptions and defaults run <code>?get_model_params</code>. Note: decomp=CP is not currently implmented.</p>

<pre><code class="r">args &lt;- list(&#39;decomp=Tucker&#39;, &#39;row.share=T&#39;,
             &#39;A1.intercept=T&#39;, &#39;A2.intercept=T&#39;, &#39;A3.intercept=F&#39;,
             &#39;H1.intercept=T&#39;, &#39;H2.intercept=T&#39;, &#39;H3.intercept=T&#39;,
             &#39;plot=F&#39;, &#39;verbose=F&#39;,
             &#39;R1=4&#39;, &#39;R2=4&#39;, &#39;R3=4&#39;,
             &#39;sigma2=auto&#39;,
             &#39;m1.alpha=1e-10&#39;, &#39;m2.alpha=1e-10&#39;, &#39;m3.alpha=1&#39;,
             &#39;m1.beta=1e10&#39;, &#39;m2.beta=1e10&#39;, &#39;m3.beta=1&#39;,
             &#39;core.0D.alpha=1&#39;, &#39;core.0D.beta=1&#39;, 
             &#39;core.1D.alpha=1e-4&#39;, &#39;core.1D.beta=1e4&#39;,
             &#39;core.2D.alpha=1e-8&#39;, &#39;core.2D.beta=1e8&#39;,
             &#39;core.3D.alpha=1e-12&#39;, &#39;core.3D.beta=1e12&#39;,
             &#39;parallel=T&#39;, &#39;cores=1&#39;, &#39;lower.bnd=T&#39;, 
             &#39;update.order=c(3,1,2)&#39;, &#39;show.mode=c(1,2,3)&#39;)
model.params &lt;- get_model_params(args)
model &lt;- mk_model(train.data, model.params)
model$rand_init(model.params)
</code></pre>

<pre><code>## [1] &quot;** Initialization complete **&quot;
</code></pre>

<p><code>model</code> is an <code>R6</code> object containing A mean matrices (ex. <code>model$mode1.A.mean</code>), A covariance arrays (ex. <code>model$mode1.A.cov</code>), H mean and variance matrices (ex. <code>model$mode1.H.mean</code> and <code>model$mode1.H.var</code>), arrays for the core mean and variance (<code>model$core.mean</code> and <code>model$core.var</code>), an array of predicted responses (<code>model$resp</code>) and parameters for the prior distributions. Initially these are random values sampled from Gaussian distributions.</p>

<pre><code class="r">par(mfrow=c(2,2), mar=c(2,2,2,2), mgp=c(1,0,5))
im_mat(model$mode1.A.mean, main=&#39;Mode 1 A mean&#39;, xlab=&#39;Latent factors&#39;, ylab=&#39;Predictors&#39;)
im_mat(model$mode2.A.mean, main=&#39;Mode 2 A mean&#39;, xlab=&#39;Latent factors&#39;, ylab=&#39;Predictors&#39;)
im_mat(model$mode3.H.mean, main=&#39;Mode 3 H mean&#39;, xlab=&#39;Latent factors&#39;, ylab=&#39;Samples&#39;)
if(model.params$decomp==&#39;Tucker&#39;)
  im_mat(model$core.mean[,,1], main=&#39;Core mean&#39;, xlab=&#39;mode 2 latent&#39;, ylab=&#39;Mode 1 latent&#39;)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk image model" alt="plot of chunk image model" style="display: block; margin: auto;" /></p>

<p>We&#39;re now ready to train the BaTFLED model. If <code>params$plot=TRUE</code> the predictions and some of the learned matrices will be displayed during training. You can adjust which A and H matrices are displayed by changing <code>params$show.mode</code>. The observed response values for the &#39;warm&#39; data are set to zero, so they appear along a vertical line in the first plot. You may want to adjust the number of <code>cores</code> depending on how many processors you have on your machine and the number of iterations run <code>reps</code>. With 50 iterations a Tucker decomposition can take about 10-15 minutes.</p>

<pre><code class="r">reps &lt;- 5

# Data frame to store RMSEs &amp; explained variances for test data while training 
test.results &lt;- numeric(0)

trained &lt;- model$clone()

for(i in 1:reps) {
train(d=train.data, m=trained, params=model.params)

# Get cold results
test.results &lt;- test_results(m=trained, d=train.data, test.results=test.results,
warm.resp=warm.resp, test.m1=m1.test.data, test.m2=m2.test.data, 
test.m1m2=m1m2.test.data)
}

# Stop cluster (if using parallel package)
if(.Platform$OS.type == &quot;windows&quot;) parallel::stopCluster(clust)
</code></pre>

<h2>Exploring the resulting model</h2>

<p>Now that the model has been trained, let&#39;s compare the learned matrices to the generating <code>toy</code> model. Since the latent factors (columns of the A &amp; H matrices) can be permuted or scaled without changing predictions, the function <code>im_2_mat</code> scales and reorders columns of the two matrices and tries to match the latent factors. The new ordering for the second matrix is returned (with negatives indicating negative scaling) so that it can be used to order the core.</p>

<pre><code class="r">par(mfrow=c(3,4), mar=c(2,2,2,2))
im_2_mat(toy$mode1.A, trained$mode1.A.mean, main1=&#39;Mode 1 A true&#39;, main2=&#39;Mode 1 A learned&#39;)
m1.H.order &lt;- im_2_mat(toy$mode1.H[-(1:2),], trained$mode1.H.mean, 
                       main1=&#39;Mode 1 H true&#39;, main2=&#39;Mode 1 H learned&#39;)
im_2_mat(toy$mode2.A, trained$mode2.A.mean, main1=&#39;Mode 2 A true&#39;, main2=&#39;Mode 2 A learned&#39;)
m2.H.order &lt;- im_2_mat(toy$mode2.H[-(1:2),], trained$mode2.H.mean, 
                       main1=&#39;Mode 2 H true&#39;, main2=&#39;Mode 2 H learned&#39;)
m3.H.order &lt;- im_2_mat(toy$mode3.H, trained$mode3.H.mean, 
                       main1=&#39;Mode 3 H true&#39;, main2=&#39;Mode 3 H learned&#39;)
if(model.params$decomp==&#39;Tucker&#39;) {
  core.reorder &lt;- trained$core.mean[abs(m1.H.order), abs(m2.H.order), abs(m3.H.order)]
  core.reorder &lt;- core.reorder * outer(sign(m1.H.order), outer(sign(m2.H.order), sign(m3.H.order)))
  im_2_mat(toy$core[,,1], core.reorder[,,1], sort=F, center=T, scale=&#39;all&#39;,
           main1=&#39;Core slice true&#39;, main2=&#39;Core slice learned&#39;)
}
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk compare model matrices" alt="plot of chunk compare model matrices" style="display: block; margin: auto;" /></p>

<p>To quantify how well BaTFLED has chosen predictors we can generate receiver operating characteristic (ROC) curves for each of the modes with predictors. Predictors are &#39;chosen&#39; if the sum of squared values in the corresponding row of the scaled A matrix is large.</p>

<pre><code class="r">par(mfrow=c(1,2), mar=c(3,3,2,2), mgp=c(2,1,0))
plot_roc(toy$mode1.A, trained$mode1.A.mean, main=&#39;Mode 1&#39;)
plot_roc(toy$mode2.A, trained$mode2.A.mean, main=&#39;Mode 2&#39;)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk ROC curves" alt="plot of chunk ROC curves" style="display: block; margin: auto;" /></p>

<p>BaTFLED optionally stores values of the lower bound (<code>lower.bnd</code>), root mean squared error (<code>RMSE</code>), explained variation (<code>exp.var</code>), Pearson correlation (<code>p.cor</code>) and Spearman correlation (<code>s.cor</code>) for training data.</p>

<pre><code class="r">par(mfrow=c(2,2), mar=c(3,3,2,2), mgp=c(2,1,0))
if(model.params$lower.bnd) plot(trained$lower.bnd, main=&#39;Lower bound&#39;)
if(model.params$RMSE)      plot(trained$RMSE, main=&#39;Training RMSE&#39;)
if(model.params$exp.var)   plot(trained$exp.var, main=&#39;Training explained variation&#39;)
if(model.params$cor)       plot(trained$s.cor, main=&#39;Spearman correlation&#39;)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk training measures" alt="plot of chunk training measures" style="display: block; margin: auto;" /></p>

<p>Also the <code>test.results</code> object in the training loop has stored results for the test data which can be plotted with the functions below.</p>

<pre><code class="r">par(mfrow=c(2,2))
plot_test_RMSE(test.results, main=&quot;Test RMSEs&quot;)
plot_test_exp_var(test.results, main=&quot;Test explained variances&quot;)
plot_test_cor(test.results, main=&quot;Pearson correlation&quot;)
plot_test_cor(test.results, main=&quot;Spearman correlation&quot;, method=&#39;spearman&#39;)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk unnamed-chunk-2" alt="plot of chunk unnamed-chunk-2" style="display: block; margin: auto;" /></p>

</body>

</html>
