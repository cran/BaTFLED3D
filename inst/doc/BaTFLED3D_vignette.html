<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Example usage</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<p>BaTFLED is a machine learning algorithm designed to make predictions and determine interactions in data that varies along three independent modes. For example BaTFLED was developed to predict the growth of cell lines when treated with drugs at different doses. The first mode corresponds to cell lines and incorporates predictors such as cell line genomics and growth conditions. The second mode corresponds to drugs and incorporates predictors indicating known targets and structural features. The third mode corresponds to dose and there are no dose-specific predictors (although the algorithm is capable of including predictors for the third mode if present). </p>

<p>BaTFLED assumes a generative model where matrices of predictors are multiplied through projection matrices to form latent representations of the input data. These latent representations vectors are analogous to principal component vectors. Matrices containing the latent vectors are combined to form the response tensor which, in this case, are measures of the growth of cell lines after treatment with different drugs at different doses.</p>

<p>The algorithm learns distributions on values in the projection matrices and latent matrices using a Bayesian framework. Prior distributions on the projection matrices can encourage a sparse representation of the input data. Values in the model are learned through variational approximation which maximizes a lower bound on the posterior likelihood by iteratively updating values in the model. This process is deterministic given a random initialization and update ordering.</p>

<h2>Example usage</h2>

<p>This document will walk through the use of BaTFLED on a small simulated dataset.</p>

<p>First we check for installation of necessary packages, install them if necessary and load them.</p>

<pre><code class="r">library(BaTFLED3D)

# Set up backend for parallel execution
cores &lt;- 1
if(.Platform$OS.type == &quot;windows&quot;) {
  clust &lt;- parallel::makeCluster(cores)
  doParallel::registerDoParallel(clust)
} else doMC::registerDoMC(cores)
</code></pre>

<h2>Generating a simulated dataset</h2>

<p>Next we generate simulated data according to the assumed generative model which we will try to reconstruct using BaTFLED. Many aspects of model building can be adjusted, use <code>?get_data_params</code> to see them.</p>

<pre><code class="r">args &lt;- list(&#39;decomp=Tucker&#39;,             # Should be either CP or Tucker factorization
             &#39;m1.rows=20&#39;, &#39;m1.cols=80&#39;,  # Dimensions of input matrices
             &#39;m2.rows=25&#39;, &#39;m2.cols=100&#39;,
             &#39;m3.rows=5&#39;, &#39;m3.cols=0&#39;,
             &#39;A1.intercept=T&#39;,            # Add intercepts to projection matrices
             &#39;A2.intercept=T&#39;, 
             &#39;A3.intercept=F&#39;,
             &#39;H1.intercept=T&#39;,            # Add intercepts to latent matrices
             &#39;H2.intercept=T&#39;, 
             &#39;H3.intercept=T&#39;,
             &#39;m1.true=8&#39;,                 # Number of predictors affecting output 
             &#39;m2.true=10&#39;, 
             &#39;m3.true=0&#39;,
             &#39;R1=4&#39;, &#39;R2=4&#39;, &#39;R3=4&#39;,      # Core dimension
             &#39;core.spar=0.1&#39;,             # Amount of sparsity in the core [0-1], 1=no sparsity
             &#39;noise.sd=0.2&#39;               # Amount of Gaussian noise added to responses
)
data.params &lt;- get_data_params(args)
toy &lt;- mk_toy(data.params)
</code></pre>

<p>The <code>toy</code> list contains the input matrices (<code>mode1.X</code>, <code>mode2.X</code> and <code>mode3.X</code>), the sparse projection matrices (<code>mode1.A</code>, <code>mode2.A</code> and <code>mode3.A</code>), the latent matrices (<code>mode1.H</code>, <code>mode2.H</code> and <code>mode3.H</code>), the core tensor (<code>core</code> if a &#39;Tucker&#39; decomposition is used) and the response tensor (<code>resp</code>). The matrices and slices of the tensors can be view using <code>im_mat()</code>. Note that there are normally some patterns visible in the response tensor.</p>

<pre><code class="r">par(mfrow=c(2,2), mar=c(2,2,2,2), mgp=c(1,1,1))
im_mat(toy$mode1.X, main=&#39;Mode 1 X&#39;, ylab=&#39;Samples&#39;, xlab=&#39;Predictors&#39;)
im_mat(toy$mode1.A, main=&#39;Mode 1 A&#39;, ylab=&#39;Predictors&#39;, xlab=&#39;Latent factors&#39;)
im_mat(toy$mode1.H, main=&#39;Mode 1 H&#39;, ylab=&#39;Samples&#39;, xlab=&#39;Constant + latent factors&#39;)
im_mat(toy$resp[,,1], main=&#39;Slice of response tensor&#39;,
       xlab=&#39;Mode 2 samples&#39;, ylab=&#39;Mode 1 samples&#39;)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk mode 1 mats" alt="plot of chunk mode 1 mats" style="display: block; margin: auto;" /></p>

<h2>Training a BaTFLED model</h2>

<p>Now that we&#39;ve built a model, let&#39;s see if we can get BaTFLED to learn the values in the projection and latent matrices and the core tensor given just the input data and responses. We separate two of the &#39;samples&#39; from modes 1 and 2 to be used as test data and form <code>input_data</code> objects. We also set a percentage of training responses to <code>NA</code> to be used for &#39;warm start&#39; testing. If the <code>X</code> matrices contain constants they are removed since these is optionally added during training.</p>

<pre><code class="r">train.data &lt;- input_data$new(
  mode1.X=toy$mode1.X[-c(1,2), !grepl(&#39;const&#39;, colnames(toy$mode1.X))],
  mode2.X=toy$mode2.X[-c(1,2), !grepl(&#39;const&#39;, colnames(toy$mode2.X))],
  mode3.X=toy$mode3.X[, !grepl(&#39;const&#39;, colnames(toy$mode3.X))],
  resp=toy$resp[-c(1,2),-c(1,2),])

# Remove &#39;warm.per&#39; percent of responses to be used as &#39;warm&#39; test data
warm.per &lt;- 0.05
warm.idx &lt;- sample(1:prod(dim(train.data$resp)), prod(dim(train.data$resp))*warm.per)
warm.resp &lt;- train.data$resp[sort(warm.idx)]
train.data$resp[warm.idx] &lt;- NA
train.data$delta[warm.idx] &lt;- 0

m1.test.data &lt;- input_data$new(
  mode1.X=toy$mode1.X[c(1,2), !grepl(&#39;const&#39;, colnames(toy$mode1.X))],
  mode2.X=toy$mode2.X[-c(1,2), !grepl(&#39;const&#39;, colnames(toy$mode2.X))],
  mode3.X=toy$mode3.X[, !grepl(&#39;const&#39;, colnames(toy$mode3.X))],
  resp=toy$resp[c(1,2),-c(1,2),])
m2.test.data &lt;- input_data$new(
  mode1.X=toy$mode1.X[-c(1,2), !grepl(&#39;const&#39;, colnames(toy$mode1.X))],
  mode2.X=toy$mode2.X[c(1,2), !grepl(&#39;const&#39;, colnames(toy$mode2.X))],
  mode3.X=toy$mode3.X[, !grepl(&#39;const&#39;, colnames(toy$mode3.X))],
  resp=toy$resp[-c(1,2),c(1,2),])
m1m2.test.data &lt;- input_data$new(
  mode1.X=toy$mode1.X[c(1,2), !grepl(&#39;const&#39;, colnames(toy$mode1.X))],
  mode2.X=toy$mode2.X[c(1,2), !grepl(&#39;const&#39;, colnames(toy$mode2.X))],
  mode3.X=toy$mode3.X[, !grepl(&#39;const&#39;, colnames(toy$mode3.X))],
  resp=toy$resp[c(1,2),c(1,2),])
</code></pre>

<p>To train BaTFLED we create and initialize a <code>model</code> object. Again there are a lot of parameters to specify, a subset of which are indicated below. To see all available parameters, their descriptions and defaults run <code>?get_model_params</code>. Note: decomp=CP is not currently implmented.</p>

<pre><code class="r">args &lt;- list(&#39;decomp=Tucker&#39;, &#39;row.share=T&#39;,
             &#39;A1.intercept=T&#39;, &#39;A2.intercept=T&#39;, &#39;A3.intercept=F&#39;,
             &#39;H1.intercept=T&#39;, &#39;H2.intercept=T&#39;, &#39;H3.intercept=T&#39;,
             &#39;plot=F&#39;, &#39;verbose=F&#39;,
             &#39;R1=4&#39;, &#39;R2=4&#39;, &#39;R3=4&#39;,
             &#39;sigma2=auto&#39;,
             &#39;m1.alpha=1e-10&#39;, &#39;m2.alpha=1e-10&#39;, &#39;m3.alpha=1&#39;,
             &#39;m1.beta=1e10&#39;, &#39;m2.beta=1e10&#39;, &#39;m3.beta=1&#39;,
             &#39;core.0D.alpha=1&#39;, &#39;core.0D.beta=1&#39;, 
             &#39;core.1D.alpha=1e-4&#39;, &#39;core.1D.beta=1e4&#39;,
             &#39;core.2D.alpha=1e-8&#39;, &#39;core.2D.beta=1e8&#39;,
             &#39;core.3D.alpha=1e-12&#39;, &#39;core.3D.beta=1e12&#39;,
             &#39;parallel=T&#39;, &#39;cores=1&#39;, &#39;lower.bnd=T&#39;, 
             &#39;update.order=c(3,1,2)&#39;, &#39;show.mode=c(1,2,3)&#39;)
model.params &lt;- get_model_params(args)
model &lt;- mk_model(train.data, model.params)
model$rand_init(model.params)
</code></pre>

<pre><code>## [1] &quot;** Initialization complete **&quot;
</code></pre>

<p><code>model</code> is an <code>R6</code> object containing A mean matrices (ex. <code>model$mode1.A.mean</code>), A covariance arrays (ex. <code>model$mode1.A.cov</code>), H mean and variance matrices (ex. <code>model$mode1.H.mean</code> and <code>model$mode1.H.var</code>), arrays for the core mean and variance (<code>model$core.mean</code> and <code>model$core.var</code>), an array of predicted responses (<code>model$resp</code>) and parameters for the prior distributions. Initially these are random values sampled from Gaussian distributions.</p>

<pre><code class="r">par(mfrow=c(2,2), mar=c(2,2,2,2), mgp=c(1,0,5))
im_mat(model$mode1.A.mean, main=&#39;Mode 1 A mean&#39;, xlab=&#39;Latent factors&#39;, ylab=&#39;Predictors&#39;)
im_mat(model$mode2.A.mean, main=&#39;Mode 2 A mean&#39;, xlab=&#39;Latent factors&#39;, ylab=&#39;Predictors&#39;)
im_mat(model$mode3.H.mean, main=&#39;Mode 3 H mean&#39;, xlab=&#39;Latent factors&#39;, ylab=&#39;Samples&#39;)
if(model.params$decomp==&#39;Tucker&#39;)
  im_mat(model$core.mean[,,1], main=&#39;Core mean&#39;, xlab=&#39;mode 2 latent&#39;, ylab=&#39;Mode 1 latent&#39;)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk image model" alt="plot of chunk image model" style="display: block; margin: auto;" /></p>

<p>We&#39;re now ready to train the BaTFLED model. If <code>params$plot=TRUE</code> the predictions and some of the learned matrices will be displayed during training. You can adjust which A and H matrices are displayed by changing <code>params$show.mode</code>. The observed response values for the &#39;warm&#39; data are set to zero, so they appear along a vertical line in the first plot. You may want to adjust the number of <code>cores</code> depending on how many processors you have on your machine and the number of iterations run <code>reps</code>. With 50 iterations a Tucker decomposition can take about 10-15 minutes.</p>

<pre><code class="r">reps &lt;- 5

# Data frame to store RMSEs &amp; explained variances for test data while training 
test.results &lt;- numeric(0)

trained &lt;- model$clone()

for(i in 1:reps) {
train(d=train.data, m=trained, params=model.params)

# Get cold results
test.results &lt;- test_results(m=trained, d=train.data, test.results=test.results,
warm.resp=warm.resp, test.m1=m1.test.data, test.m2=m2.test.data, 
test.m1m2=m1m2.test.data)
}

# Stop cluster (if using parallel package)
if(.Platform$OS.type == &quot;windows&quot;) parallel::stopCluster(clust)
</code></pre>

<h2>Exploring the resulting model</h2>

<p>Now that the model has been trained, let&#39;s compare the learned matrices to the generating <code>toy</code> model. Since the latent factors (columns of the A &amp; H matrices) can be permuted or scaled without changing predictions, the function <code>im_2_mat</code> scales and reorders columns of the two matrices and tries to match the latent factors. The new ordering for the second matrix is returned (with negatives indicating negative scaling) so that it can be used to order the core.</p>

<pre><code class="r">par(mfrow=c(3,4), mar=c(2,2,2,2))
im_2_mat(toy$mode1.A, trained$mode1.A.mean, main1=&#39;Mode 1 A true&#39;, main2=&#39;Mode 1 A learned&#39;)
m1.H.order &lt;- im_2_mat(toy$mode1.H[-(1:2),], trained$mode1.H.mean, 
                       main1=&#39;Mode 1 H true&#39;, main2=&#39;Mode 1 H learned&#39;)
im_2_mat(toy$mode2.A, trained$mode2.A.mean, main1=&#39;Mode 2 A true&#39;, main2=&#39;Mode 2 A learned&#39;)
m2.H.order &lt;- im_2_mat(toy$mode2.H[-(1:2),], trained$mode2.H.mean, 
                       main1=&#39;Mode 2 H true&#39;, main2=&#39;Mode 2 H learned&#39;)
m3.H.order &lt;- im_2_mat(toy$mode3.H, trained$mode3.H.mean, 
                       main1=&#39;Mode 3 H true&#39;, main2=&#39;Mode 3 H learned&#39;)
if(model.params$decomp==&#39;Tucker&#39;) {
  core.reorder &lt;- trained$core.mean[abs(m1.H.order), abs(m2.H.order), abs(m3.H.order)]
  core.reorder &lt;- core.reorder * outer(sign(m1.H.order), outer(sign(m2.H.order), sign(m3.H.order)))
  im_2_mat(toy$core[,,1], core.reorder[,,1], sort=F, center=T, scale=&#39;all&#39;,
           main1=&#39;Core slice true&#39;, main2=&#39;Core slice learned&#39;)
}
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk compare model matrices" alt="plot of chunk compare model matrices" style="display: block; margin: auto;" /></p>

<p>To quantify how well BaTFLED has chosen predictors we can generate receiver operating characteristic (ROC) curves for each of the modes with predictors. Predictors are &#39;chosen&#39; if the sum of squared values in the corresponding row of the scaled A matrix is large.</p>

<pre><code class="r">par(mfrow=c(1,2), mar=c(3,3,2,2), mgp=c(2,1,0))
plot_roc(toy$mode1.A, trained$mode1.A.mean, main=&#39;Mode 1&#39;)
plot_roc(toy$mode2.A, trained$mode2.A.mean, main=&#39;Mode 2&#39;)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk ROC curves" alt="plot of chunk ROC curves" style="display: block; margin: auto;" /></p>

<p>BaTFLED optionally stores values of the lower bound (<code>lower.bnd</code>), root mean squared error (<code>RMSE</code>), explained variation (<code>exp.var</code>), Pearson correlation (<code>p.cor</code>) and Spearman correlation (<code>s.cor</code>) for training data.</p>

<pre><code class="r">par(mfrow=c(2,2), mar=c(3,3,2,2), mgp=c(2,1,0))
if(model.params$lower.bnd) plot(trained$lower.bnd, main=&#39;Lower bound&#39;)
if(model.params$RMSE)      plot(trained$RMSE, main=&#39;Training RMSE&#39;)
if(model.params$exp.var)   plot(trained$exp.var, main=&#39;Training explained variation&#39;)
if(model.params$cor)       plot(trained$s.cor, main=&#39;Spearman correlation&#39;)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk training measures" alt="plot of chunk training measures" style="display: block; margin: auto;" /></p>

<p>Also the <code>test.results</code> object in the training loop has stored results for the test data which can be plotted with the functions below.</p>

<pre><code class="r">par(mfrow=c(2,2))
plot_test_RMSE(test.results, main=&quot;Test RMSEs&quot;)
</code></pre>

<pre><code>## Warning in if (is.na(ylim)) ylim = c(0, max(test.results[-1,
## grepl(&quot;RMSE&quot;, : the condition has length &gt; 1 and only the first element
## will be used
</code></pre>

<pre><code class="r">plot_test_exp_var(test.results, main=&quot;Test explained variances&quot;)
plot_test_cor(test.results, main=&quot;Pearson correlation&quot;)
</code></pre>

<pre><code>## Warning in if (is.na(ylim)) ylim = range(test.results[-1, cor.cols], na.rm
## = T): the condition has length &gt; 1 and only the first element will be used
</code></pre>

<pre><code class="r">plot_test_cor(test.results, main=&quot;Spearman correlation&quot;, method=&#39;spearman&#39;)
</code></pre>

<pre><code>## Warning in if (is.na(ylim)) ylim = range(test.results[-1, cor.cols], na.rm
## = T): the condition has length &gt; 1 and only the first element will be used
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAbAAAAGwCAMAAAD/kMAYAAABdFBMVEUAAAAAAAUAACgAACsAAE8AAFUACRMAKHcAK4AAT54AVVUAVaomCQkmDRMoAAAoACgoAE8oKCgoKE8oKHcoT08oT54od54od8UrAAArACsrAFUrKwArKysrK1UrK4ArVVUrVaorgIArgKorgNQ3frhMAABMBAVMBAlNr0pPAABPAChPAE9PKChPKE9PKHdPTwBPTyhPT09PT55Pd8VPnp5Pnu1VAABVACtVAFVVKytVK4BVVStVVVVVVapVgNRVqtRVqv93KAB3KCh3KE93T3d3d093xcV3xe2AKwCAKyuAK1WAgCuAgFWAgKqA1KqA1P+YTqOeTwCeTyieT0+ed0+ed3eenk+exXee7cWe7e2qVQCqVSuqVVWqgCuqgICqqlWq/6qq/9Sq//++DQXFdyjFd0/FxXfF7Z7F7cXF7e3UgCvUqlXU/6rU/9TU///kFg7kGhPkGhztnk/txXft7Z7t7cXt7e3/qlX/1ID//6r//9T////U1mgcAAAACXBIWXMAAAsSAAALEgHS3X78AAAbm0lEQVR4nO2di2Pbtp3HeXV9tU93WbM0U7qlXW/U3Zyty572ct26cc02O7m1crpHF2W3azVvjX2pNtkJ/dA/f3jxJQEgCQIgfsrv21SS+RK++uAHgiAARgsUKEV9JwDVTggMmBAYMCEwYEJgwITAgAmBARMCAyYEBkwIDJgQGDAhMGBCYMCEwIAJgQETAgMmBAZMCAyYEBgwITBgcgJsthVRHVxVF4+fsNcNuu6Evk8Wi0F062KxSMiSc76G/tmDtEmWKiEpXv5U0mDvsmY3M7mKMEm6ppsT+jbeOFks4lsX443bB1ezrduEEFk029q7ZGv6kzrJTTcvSwWsq9wCIzFDIyamAUTzMM3ADAtZPd7473uX03v/zoEtFovsjW/uKF1GSRYLxxsTmtOS6CcbpISgm8esrGBm2LJi771/ocBmWxP2P99uuvm1jVu/yXcr7VPZVW/eKTBKYMAjZ3DrohxhAxph//P2xfjBN0gqp5s0xWVugx5KRn2SacQM9j4lCxICMY7OKaY3L+hyBuzgC1FG8L2nmyzC4r3L6Wa2HVtW7Cb2mbJDnle/WJ1Kp8BIduRpYYnP3UfijHUyOE8mdBu6jGzC1hxcic29S51ksZBmLPaT0+g4YZsn9KRb/NxiQ/rGi0TCJhEnaYG/2E3sI4rW6her5RZYFIkyI4p4Vlqw7MqyGnmP6X88O8XCAd+Xbu4oYSZJzhaSKhIvzilJ8esOKsD4htRTzBzMtk5ingUHBTDxZ77Pefk76sw7jzAhkqxS+ZKQCiLNpJPBebaNcF1s7ihhJknOFpJ6EouDLMJEJFUjTGwvKh3xZHCS/Z0BE3+uRljxxepUOj+HsbM0OzGXgM22WAYb/9dbFyw30hNxHmFic0cJM00yWTjbIiedgyt2DmNxxZCWI0xsWJzDyK7cH90uB8b/FPvQpfS3qHyxOpVua4n8+oq9sQKFmhC1xAmryzPrdI24MmPbi819S51ksTBmaTspaom0FvlTXv0Q1RKxd1ZLpGUiqWaK7TJg4s9sH2p7svzFSmFLR2slfeSmXAistRAYqoUQGDAhMGBCYMCEwIAJgQETAgMmBAZMCAyYEBgwITBgQmDAhMCACYEBkw7Y9OEV73aybkqiqJ+edBZUA+ydC/rqLTV+NHubdp8Y/xhkTqwHNnsPpDGNeBYE6ksLbHPys9UIiyxqxN92dnb4h/m87RFMPE+/Koswm766ywgY6yvD3ZX3SK1plH3Y4W/z1kcwqzMl7DdZOodZ9NVdpsCke9hL1qjy17w9L0Ngrn11VxdgRVkvotVaqpZ4mRyiAzB3viwozAgb1W9SJ4wwj8YEr50ux0BgHo1xYIyXUXFIhcDKmm6ysn2pqcOWsVKAzU3qGzXGevNlRYYRNn4gaeSwZYxD4gWi5whz6suKTIvEWNLeZsnYnIUV47X/yhF53b12Vqy9WfqcPv728/bG+vJlR+Gdw+ZMPL723/0OIXLzugLYbnTHGBi58h80bOT1C+xQvyZgYCTM9j/4ymm6/7sbZ+l2FD1KyeudN9hnGnjp8e+P75oCm9776Mn0XrM2Q6/ADg8PxVtZxZrggI3SghcB9uuP0x/+7cbZLqV1Sl4fv84+D0/ZxusETGABF2EjGmOCFwH29O7nv3x644wC2j2irzfPhrQix0KsA7BslJw3XzrlQdRAoQFjVfqMFwH2Yvirvx6XIox+Psq37gDMsy+V2rBiChSYqM0TYPtfOjsuncOuXWefo65F4iI+mW31GGGls1I7BQasyquLas9hl4sez2EmqLgCBGaFVx0w2iLfZ6XDlFdgwOzxAlXpaKMAgVnhBaXS0VpBARO8RhZuhyEwD8ZyXjmxpm2J+6/QOiTR8WtR9IsXemNcg9VWeVe+lmV8/qIKDhjjlRFr2pa4fSoq+Px6TW+MSV7hkHeQtQysE6+QgHFeVWAN2xJJhBVX08MmwOR9D+UdZO0C68YrMGCsjb5cJDZrSyQFIS8HqXYf1RjjaDZlRaK8g6xVYB15BQRslHfiKCodDdsSh0fp7ndf52Xl9qM6YxopOsh28lVVV15BAZuv9Lpp2JY4fJSBOn7ttNaYVo47yHbmFQ4wGa+mbYm0bnjKiG3n0RdkLbE7r4CASXh1UW0t8dOHn/1Jvs5ZR1ILvIIBNurWC3FVtcCevfes4SgVW8Bs8DIF5mDQgF9gi3gSR+pnBbgAZoWXITD5wDdjY7T10DKv8Eav2OFl2pFUOvDN1Nhyb9EdG/C0wKYPP5Neh1nOiBX1C0w+8K3ld88zUtXG3p2dnJi+LbFoOGxlTOfLakasyBIvn+ewAgsBNRoVTVCjnTKxnZ2CmL4tsWg4bGWshGZlqZWMKJMtXh5riRmdclsh106lDKwA07YlUg1NgUmLRGfnMGu8PA7omx/yLvNVsVXVc1a5SKxpS8waDlsZa63uwOzx8hhhzfudFAFX15a4reQVFDCLvHxeOIuOrW06DOnbEouGw1bGuDw2Tdnk1U9LR6nDuF76tsSi4bCVMSZd05SxL4XbbrsvSQ+M3oF9eLV6s8/OwLfD+u7k5gqmacqyOTNgdge+mfeq1CiUpinb1gyB2R341kOEtRGgXlNqYICNMa3cpYTviwGTnqtcG7NSQtZF2GyraYkICVg7WSrrSxXIm2cpqSXSyqJFY7kS1xnRb1Hvu09H5q5c5SdXysPvH6W7qrq7kTGhgfMI81yZYmvow2t9DRoQ7srA9j9Ob35y/8VNcR02vH7nk++9Gh1tqxvpGxhjmm5KTVlqS8xGJbfesV56YLO3L2b0GdjNZh611CJQKhIf3//j/ad3P7/7nJAjl8/DR+n+t54/fvVU3UjfwJhGFu6HtR5S2VK1tURCy1stMSeWL/nBj47S4R9+SwrHKLp2NjyiMUe7SjkC1u1+mGtWTDUR9t5lcrJIDvxEmKQMGV4/Tfe/fES7itIIcw7M/H6YB1ZMNeewhFTp46azZzu4b0RKQHpHhXaev/bGqXNgRucwP6AyhVNL5PJwZ3Zh9/pShFb5/p5LBXfh7L7vAxMb46yYxt3oxqyQ5sasa19sTfOLFVvA3PcuYrI3i0DTrg+WVFskJs0fJg8JmMVB6Rkk1gms3LloOcKM535s5qtY07TWAaSHrE5dL5zn5T6WSwFXWudkWsEiwjzWEpkc90HXyEpH0gLMCq9shZNpBUWlw/s5LHU9yoNLOl+itY6knMy8uqgEzMW0gv3dXnE8joqjkU6/Z7cjaT5PZ/5nXiS6mFawn+swIZcjFTXALHcknVerHcXpzcm0gr0CczkWuEDj4S6EvGLvZFpBtiYmrmZbfUxA4m60fWt18DVSArM/rSA7h927HN9+c7X3g48JSJzNZ+EVmMdxb1knHFlzgI8JSJzNGMPlqeevIsTM1aTXlAqY0wlIuqpB01RTQQKmqNa7n4Cksxo0/noBZnlyBONaouMJSHI5mLmTSTE+zCkwx9MK9lutF3IxN65fXwUx19MK2h7QZyY3EaYalO4SmPNpBYOIMC6TMAsmwlIZMBfTCgYEzKRoDAdYOcTEQifTCvqeCadO1p6gwOVtBGZx7ex4WkGPM+E0VRtmwYzAHEnmCXcyraC/mXDaqDGzYEZgjiQtwE6mFXQ/E46hmo2zDWUEJgNmZyp+JjjnsCVVH4xWXaU31lqW5jK2IyC1RIkqkNo8yW7R/E66letLuyEGF5haIUaYNWLrCIwpKGA8xBxPK7jmwDw+3UiEmOtpBdcbmM8HvvEQcz6t4HoDW7yvHgxh2xd/RonzaQXXG1ibHpd2gM1dTyu43sC8+sqJZQucTCu43sCmtB3xfU/d98Rzm4qqvZNpBdcb2CI5+MLbY4FXnp3rZFrBNQdGpyDx5av6NPFuemmB+Yyw1TLRXC8rMK/nMJsh9rIC8+srA2aB2MsJzPc8kLxvwOEhAlMrKGCMGLv9w4k5mVYQgVn0Ncpu2XFgTqYVfCmBubqTngPjIeZkWsG1BqZoSXTXG2yUTSvIgDmZVjDwPh11MqoluusNxk9ieUXRxbSCAfZLbCMzYM56g5WmxqHEXEwrGGa/xMbqZyYcpZaAuZhWMNh+ic0U1IVzukLMWHgOW5WTkqNnYPI9LPiypoAjrBOx0Af0GcsKMIu+xMiVzj3dMMJ8+ZJOodheCKwsO89Fk8tSiGGloyKrz0WrqgrM+DRm9cI5KBkBkz8XzYpG/G2Hvc7nc9PjGAGTXzjX7Gb0VZYPZ67wfbW/cHaREgTW6HC1qxMWnbJOLOEbq5GiA3f4vgxth2+sRgisU0qwSGx0uAarPaUEgTU6XIPVqNCEwIAJgQETAgMmBAZMCAyYEBgwITBgMgI2iG6pxjWqZsWYbUWR6rnDA83kJ7HiwYFkH2UajAXBlwmw5OBK9dDnRDXFQjIhiZEnn6xSTn6SKJ70yG/VWRYIXybASO5QpGT2Z91YEdltQy6VsfGDn8uNTd/aaPOQumYC4csI2Ln6kQsaY4kyJQNFfiN+E/mahGR49e9kKBC+7EaYzthAl3PkRXpMb8cpn36r8GwuEL4sn8OUxmbqwfw0gapzsCr1bB/bEQbCl+1aosrYQJOpyDplLlVlt0HzB083FwRfeB0GTAgMmBAYMCEwYEJgwITAgAmBARMCAyYEBkwIDJgQGDAhMGBCYMCEwIAJgQETAgMmBAZMPoDRjhIfrtx6//Cq6ZO9QlUvvjwBWx1S3PSxXgGrF1+egA2iCe+uEN/eu2R9HcgSmhPZ5/HtDWX32YDViy9/EUa778XnMbHxhHZwpVNe37vkHWfHD66cdOV1rF58+QPGO+PRfl8x7T/OjdEuXckJsbp4Byowz748RhjrvkWMkX/LOfEJYGCeffkCtnlwRbvwnRNX443o1tfPyZJneVn/BCww777wOgyYEBgwITBgQmDAhMCACYEBEwIDJgQGTAgMmBAYMCEwYEJgwITAgAmBARMCAyYEBkwIDJgQGDAhMGBCYMCEwIAJgQETAgMmBAZMCAyYEBgwITBgQmDAhMCACYEBEwIDJgQGTAgMmBAYMCEwYEJgwNQR2HRT+2QlAyXFYwjHT8p/+VMSaZ6F2PXQXd11BkbnN7D5NMrCBDt2DxpvnMy2FE9Q7Kru7mwAIw7ZnAcX/FFmJ2Tp1zZuXcQ8o/I1442fbIhIJAvoJ76cbfoR254voJbYUdjjQP+P/LVyAMeidhb0t+VfuOrsN3TNwTeYC77YoztLwKjJwd7l+M0L+jbdJBmULbp1QbeIaXoPvuDZli4g6RbL2abF9nuXZFV+lPKGxQFcixTz9KdLooOrmCRm1RlfMykt9ujOUpEYi9xDy38OiSSRJSBm+ScjushLBbGcbcpexCGqRyF/rRzAuUimZ1ho5JxInNE1LFRo5LHFHt1ZqXTwMCeBTiGJqOLn7r3LmJUMkyJFcWGJLC9Z4oegebA4irBUOYAHxeQXpb8t+V6JsxIwsdijOxsRJhIo3kS4C+OrWUiXB/nq0lF6iTCeilKELTkrAROLPbqzBIx+IU0/LZSr+XC8IQrpLEV0JUuiKOUnpapLzDJ26SiyA7hWzFmwMxX/Xrmz0mKP7iwBE9cutO7zU34m5YtOilpiniJaj5oU9ajMkjgEMSGOshhEe/9bqkd5i7ABS3hWS1x1VgImFnt0hy0dKqmePt+zEJhKCAxlQwgMmBAYMCEwYEJgwITAgAmBARMCAyYEBkwIDJgQGDAhMGBCYMCEwIBJCyyJInd9KnsUZF86YPzpcuMfw3606KpA+9IB48/fnL0H0phGoH1pgX1VlhOjoGTiGbSv9uewKA1IZnUmyL7aOwZibF191TsuynoRrX2bKasDMKC+MMKA+VpzYLRPaMPep0B8hQ7sUL+mJvn0IfNh+qqRGTA+NGU5h3o1dnh4KN7KKtbUAJNfawXgq06GETZ+cCXZw3Viy1i6RtimtEjsx1cb1QJTlPWxpL3NhTEBpwSqszGtfPkyVh2wnsv6lpRKAltLNC45+Jo27WruIsxAdcCS1RYNn75WVD0Dm5ybRYTJy/r+jDVVg1pi09LDbUZcLu47RlgbIbDGKsWRNV+9AzMuDZkCLxIdFPVRz8a68YJb6ahRk1piL0VHR156YNOHn/V2bnaWEfsF1pVXqBFmfJmSKcwisbOt+krHw6vGlyxAfPVY6ehuqw7YgLUZHkjaoeD6omv6Kett+GoSYU1lyZeF8EqDjDArvsI7h9mxVV/pkJb1ZOl0cyXwgBjjkjZqu/NlJ7zSWmCKsp4Ye+dipVixAsy9Me7g3qcPP/vTylJHvqzhahZhErvM2HLkWcmJFo7BVAvs2XvPZCWHC1/2cJnfcZ78DGxO5IondOpQH74smkrNb2Am0YR3k7UJzE9O1Mq+L6u4mrR0yMp6xR4d0+IpJy5UfTdc+bKqemCysp7LcodLu1kxhI6kloOLqbZIlJb1ij06pcRb0dFapr7M+zdoFOCFsx3V3w+bDFy3kfqPMGVZD3mUB9P03kdPJHchIPtqPwITSE7UALPoy4UnKsPrMOlIRSBlPZf0tpE9X654NbkfJinrFSMVTRPRQ4TJZcuXixwoVF+tX7uynvuS316x48sdLmNg8j3af727rGjWt96KL5e8+u0i4LDk6O86zKWptNfrMLfO+rrj7BaX6e0VI2M75T+c1AzL6qlIdM3LY9/6nZ2CmGtaaU9FYq++rBeJnBfh5sFWP8Cs+NrRr/FYJGauDim0nXLAqdNoLn996/PUr/Ay8SV+l52qijW+hxuVo6uaEsvyNnolM3F4KP+FGyrPwR0jrI1qgKkLjLywtAjO33AjnmiZu0a+losbY1+2gTWqF+40T75xTuSyfH1Z423Fl3Ee9Xjh3OaULC8gJOWNQVnfWhab3LqfBQxHr/hqS6xiqa5S76Q3xhWfzLZWM6K3NlLjwt8MmOX7YRo5MGbbl4+LlEJmRaLd+2FO1GAmnFVgJr6ct9lUZXgD0+79MMsa0RezG5gmvgKLsJ7L+lH7NaPRSGtMJxNfc1NvRgpwyOxISHwuL2q0plmEtZDe13xkQswgI9b5KmbCUQGz1uFS/M7lH72LsVRvrFbtfFVzThO7Kzu1yaIer8NWMuJSGu3K33VYlvg5UTXXVTOiZJXucIo1/lo6qJ3sm5dy42h5S+2BmqmfC+d5yeVKRiz7MrZoCMzk5FzkN/12JdP7r/yFvO5eOyvW3ix9Th9/+3l7Y1zyUTk2KlNF+pd5cVFf//SXuXVftjuSClC14ZO7osb+85v/IF6u/71YWDa2G90xBSY/L1trEOBpnZcMzSu+3v3mc+u+rHckLZX1eq/MA8+JH/zbabr/uxtn6XYUPUrn/xz9x7/+nbxGR/TXOP798V2ZsbneGEcjn0LWaoNA1WgF2Adfse/L5YWzllnJ2f4Hv/44/eHfbpztPkrT7VPy+vh19nl4yjY5vvuP+UoG5m9GfTosNwhUTZaLehe+tCMwu5f1KmalfEiNPb37+S+f3jgbnpKC4oi+3jwb0q8+Yr+GeYQp5LRBwLGv4sK5qdoaW2E2X16y/8GL4a/+elzKifTzUb5ebizVG2st+y04TnwVF84OjVVPzjJj+186O87KevJ67Tr7HJ2aG+Pq9UEDTny56dMhU00txExG83T4AtZBQYzAdNF8ajRPh2VfLhQEMBcymqcDtC8PgyFcKuhKRwcFeHsltdIWHGClw7GvXu+HiY/7r9Cqbn2b2/4rtK5FdPxaFP3ihd5Y7qupgPjqq0gst+Tvv/sd1uamMJa3uW2fioowv67RG+N63zcw5776qnRUjFXb3MjrnTfYZ3aNWbS5kZxYXHUOGwHzXiQ699VbLbFcdKjb3Nh6YYwUGLy8oNrlhUjYRaILX3knnEF04tVY6eSsa3MrGRsepbvffZ2XKdvcV22EvXNRswE4X1ml41PyX49NOE3a3IaPMkPHr52mdca4r14fAuTEVz6LwIPP+gTWpM2N1qFOmbPtPJcGfR3mxFd+e+V84LlItKK+BqW7lv8RmJ4UdJHYQXZa661McGlXVopEUL7WvPF3/Xz1B8zKyNngLpyd+9L26XBprDR0T9/mVjSwtTLG1MMNTNe+8uswz8bKgy31bW5FA1srY8KX7xuYzn1lwHo1pm1zoxoaAvN/A9O5r6xpyvud2XLRUdPmljWwtTLWWkB8hVDpqGtz21b6ChCYa18hVOv1bW5FA1srY1w+pkH36yu/gdmvMU2bW9HA1soYk+OZVvvwlTf+9misg4IG1kEvK7A17A2G3dyA+Qqh0tFBCMyfMStTywRYJDr2FQlbDe9e2jN2WEwGdPMsJbUpWqmyaIyph/6Wrn1F3BYf9uvR2OFh4YxcUQ6/f5Tuquq4Rsa43r9sfHMWiC8GjFiSdi9yOFKxbGz/4/TmJ/df3BTXK8Prdz753qvR0ba6MbuBMSbFg7Yg+9IBczr9XqnoeHz/j/ef3v387nPikFxmDh+l+996/vjVU3VjdgNjGoH2xYApHvjmdvq90sn5Bz86Sod/+C0pRKLo2tnwiOZN2qXIETDQvlzOItBYw+un6f6Xj2iXSpoTrQEbv3mR2Jp+LxRf1mfCMREpKeidB9rJ/Nobp9aAkaKP/Bs/WKl0QPa1zhfOpOgjtJoOuAfiqx4Y3ClkScqTk0VyIK/WA/W1zhFGir69y7hh3yIovtoAA9Xhcl19rXWEraMvbbVeen0GxNi6+tI6ltSIwRhbV196x7Hk1kQUlNqyAu/L0LHJATVfZflw5grfFwJzmZAegCnuJoVvrEZgfSEwlwnBIrHZ4cwVvi8E5jIh4QBD9SUEBkwIDJgQGDAhMGBCYMCEwIAJgQGTEbBBdEvVFV/5JM2tKFL0hqGzuihHmMSKURpkH2UajAXBlwmw5OBK1RUpUc2nk0xIYuTJJ6uUI0wSxbCaFoM3mguELxNgJHcoUjL7s64XoOy2IZfK2PjBz+XGpm9tNJ1XpLlA+DICdq5+HJLGWKJMiWq+YeI3ka9JSIZX/06GAuHLboTpjA10OUdepMf0ZrlyqKHCs7lA+LJ8DlMam20p8w1NoOocrEo928d2hIHwZbuWqDI20GQqsk6ZS1XZbdBmlG9TQfCF12HAhMCACYEBEwIDJgQGTAgMmBAYMCEwYEJgwITAgAmBARMCAyYEBkwIDJgQGDAhMGBCYMDkAxjtKPHhyq33D6/aPMc8RPXiyxOw1SHFbR5sG6h68eUJ2CCa8O4K8e29S9bXgSyhOZF9Ht/eUHafDVi9+PIXYbT7XnweExtPaAdXsoR2z2MdZ+k0lC668jpWL778AeOd8Wi/r5j2H+fGaJeu5IRYlc/DHrZ68eUxwlj3LWKM/FvOiU8AA/PsyxewzYMr2oXvnLgab0S3vn5OljzLy/onYIF594XXYcCEwIAJgQETAgMmBAZMCAyYEBgwITBgQmDAhMCACYEBEwIDJgQGTAgMmBAYMP0/XH+K3MQ+tTMAAAAASUVORK5CYII=" title="plot of chunk unnamed-chunk-2" alt="plot of chunk unnamed-chunk-2" style="display: block; margin: auto;" /></p>

</body>

</html>
